"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[19],{5019:function(e,a,s){s.r(a),s.d(a,{default:function(){return M}});var l=s(7437),t=s(2265),r=s(1648);let n=()=>{let[e,a]=(0,t.useState)(0),s=(0,t.useRef)(null);return(0,t.useEffect)(()=>{let e=()=>{s.current&&a(s.current.offsetWidth)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),[s,e]};var i=s(28),o=s(9354);let d=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,l.jsxs)(i.fC,{ref:a,className:(0,o.cn)("relative flex w-full touch-none select-none items-center",s),...t,children:[(0,l.jsx)(i.fQ,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:(0,l.jsx)(i.e6,{className:"absolute h-full bg-primary"})}),(0,l.jsx)(i.bU,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]})});d.displayName=i.fC.displayName;var c=s(9733),u=s(9385);let f=u.fC,x=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,l.jsx)(u.aV,{ref:a,className:(0,o.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...t})});x.displayName=u.aV.displayName;let m=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,l.jsx)(u.xz,{ref:a,className:(0,o.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...t})});m.displayName=u.xz.displayName;let h=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,l.jsx)(u.VY,{ref:a,className:(0,o.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t})});h.displayName=u.VY.displayName;var p=s(4756),b=s(4867);let g=p.fC,v=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,l.jsx)(p.ck,{ref:a,className:(0,o.cn)("border-b",s),...t})});v.displayName="AccordionItem";let j=t.forwardRef((e,a)=>{let{className:s,children:t,...r}=e;return(0,l.jsx)(p.h4,{className:"flex",children:(0,l.jsxs)(p.xz,{ref:a,className:(0,o.cn)("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",s),...r,children:[t,(0,l.jsx)(b.v4q,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})})});j.displayName=p.xz.displayName;let N=t.forwardRef((e,a)=>{let{className:s,children:t,...r}=e;return(0,l.jsx)(p.VY,{ref:a,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:(0,l.jsx)("div",{className:(0,o.cn)("pb-4 pt-0",s),children:t})})});N.displayName=p.VY.displayName;let w=t.forwardRef((e,a)=>{let{className:s,type:t,...r}=e;return(0,l.jsx)("input",{type:t,className:(0,o.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:a,...r})});w.displayName="Input";var y=s(402);let S=e=>{let[a,s]=(0,t.useState)(e.value);return(0,l.jsxs)("div",{className:"mb-4 flex space-x-2",children:[(0,l.jsx)("div",{className:"flex items-center justify-start w-1/2",children:(0,l.jsx)(y._,{className:"items-center text-xs font-semibold",children:e.text})}),(0,l.jsx)("div",{className:"flex items-center justify-end w-1/2",children:(0,l.jsx)("div",{className:"flex items-center space-x-4 resize-none",children:(0,l.jsx)(w,{className:"border leading-tight text-xs",value:a,onChange:a=>{let l=a.target.value.toLowerCase();s(l=l.startsWith("#")?"#"+l.slice(1).replace(/[^0-9a-f]/gi,""):"#"+l.replace(/[^0-9a-f]/gi,"")),/^#[0-9a-f]{6}$/i.test(l)&&e.onChange(l)},placeholder:e.placeholder})})}),(0,l.jsx)("div",{className:"w-[10px] rounded-full border",style:{backgroundColor:a}})]})};var C=e=>{let[a,s]=(0,t.useState)(e.currentGradient[0]),[n,i]=(0,t.useState)(e.currentGradient[1]),[o,d]=(0,t.useState)(e.currentGradient[2]),[c,u]=(0,t.useState)(e.currentGradient[3]);return(0,t.useEffect)(()=>{console.log([a,n,o,c]),e.onChange([a,n,o,c])},[a,n,o,c]),(0,l.jsxs)("div",{children:[(0,l.jsx)(S,{text:"Highlands",value:c,placeholder:r.ob[3],onChange:u}),(0,l.jsx)(S,{text:"Midlands",value:o,placeholder:r.ob[2],onChange:d}),(0,l.jsx)(S,{text:"Lowlands",value:n,placeholder:r.ob[1],onChange:i}),(0,l.jsx)(S,{text:"Water",value:a,placeholder:r.ob[0],onChange:s})]})},z=s(7020),k=s.n(z);let V=(e,a)=>{let s=[],l=a.canvasSize/2,t=a.canvasSize/2,r=e.dist(0,0,l,t)*a.maxDistanceFactor;for(let n=0;n<a.canvasSize;n++){s[n]=[];for(let i=0;i<a.canvasSize;i++){let o=e.noise(n*a.noiseScale,i*a.noiseScale)-e.dist(n,i,l,t)/r;o=e.constrain(o,0,1),s[n][i]=o<a.threshold?0:o}}return s},D=(e,a)=>{let s=e,l=e;for(let e=0;e<a.blurIterations;e++){l=s.map(e=>[...e]);for(let e=1;e<a.canvasSize-1;e++)for(let t=1;t<a.canvasSize-1;t++)l[e][t]=(3*s[e][t]+s[e-1][t]+s[e+1][t]+s[e][t-1]+s[e][t+1]+s[e-1][t-1]+s[e-1][t+1]+s[e+1][t-1]+s[e+1][t+1])/11;s=l}return l},E=(e,a)=>{let s=a.canvasSize,l=Array(s).fill(null).map(()=>Array(s).fill(!1)),t=[{x:s-1,y:0}];for(;t.length>0;){let{x:a,y:r}=t.shift();if(!l[a][r]&&!(e[a][r]>.001))for(let e of(l[a][r]=!0,[{x:a-1,y:r},{x:a+1,y:r},{x:a,y:r-1},{x:a,y:r+1}]))e.x>=0&&e.x<s&&e.y>=0&&e.y<s&&t.push(e)}return l},F=(e,a)=>Math.floor(Math.random()*(a-e+1))+e,G=(e,a)=>{let s=e.length,l=[];for(let t=0;t<s;t++)for(let r=0;r<s;r++)e[t][r]>a.threshold&&l.push({x:t,y:r});if(0===l.length)throw Error("No land tiles available to place the town square.");let t=F(0,l.length-1),r=l[t];return console.log(r),console.log(e[r.x][r.y]),r},I=(e,a,s,l)=>{let t=e.length,r=a,n=e[a.x][a.y];for(let i=-l;i<=l;i++)if(!(i>-s)||!(i<s))for(let o=-l;o<=l;o++){if(o>-s&&o<s)continue;let l=a.x+i,d=a.y+o;l>=0&&d>=0&&l<t&&d<t&&e[l][d]>n&&(n=e[l][d],r={x:l,y:d})}return r},R=(e,a,s)=>{let l=E(e,s),t=e.length,r=null,n=1/0;for(let e=0;e<t;e++)for(let s=0;s<t;s++)if(l[e][s]){let l=Math.abs(e-a.x)+Math.abs(s-a.y);l<n&&(n=l,r={x:e,y:s})}return r},L=e=>D(V(new(k())(e=>{}),e),e);var M=e=>{let[a,s]=(0,t.useState)(e.params.noiseScale),[i,o]=(0,t.useState)(e.params.canvasSize),[u,p]=(0,t.useState)(e.params.threshold),[b,w]=(0,t.useState)(e.params.maxDistanceFactor),[y,z]=(0,t.useState)(e.params.blurIterations),[k,V]=(0,t.useState)(r.ob),[D,E]=(0,t.useState)(r.KT),[F,M]=(0,t.useState)(r.VB),[A,_]=n(),[B,W]=n();return((0,t.useEffect)(()=>{e.onColorsChanged({terrainGradient:k,ambientLight:D,directionalLight:F})},[k,D,F]),(0,t.useEffect)(()=>{e.onParamsChanged({noiseScale:a,canvasSize:i,threshold:u,maxDistanceFactor:b,blurIterations:y})},[a,i,u,b,y]),(0,t.useEffect)(()=>{s(e.params.noiseScale),o(e.params.canvasSize),p(e.params.threshold),w(e.params.maxDistanceFactor),z(e.params.blurIterations)},[e.params]),e.display)?(0,l.jsx)("div",{id:"island-generator-container",className:"h-full",tabIndex:1,children:(0,l.jsxs)("div",{className:"border h-full flex flex-col",children:[(0,l.jsx)("div",{className:"w-full p-2",children:(0,l.jsx)(c.z,{className:"w-full pt-6 pb-6 border",style:{backgroundColor:"#0000aa"},onClick:()=>{let s={noiseScale:a,canvasSize:i,threshold:u,maxDistanceFactor:b,blurIterations:y},l=L(s),t=G(l,s),n=I(l,t,r.Br,r.ip),o=R(l,t,s);e.onWorldGenerated({heightmap:l,townSquare:t,temple:n,docks:o})},children:(0,l.jsx)("div",{className:" text-2xl font-extrabold",children:"Generate"})})}),(0,l.jsxs)(f,{defaultValue:"worldgen",className:"flex-1 flex flex-col p-2",children:[(0,l.jsxs)(x,{className:"grid w-full grid-cols-2",children:[(0,l.jsx)(m,{ref:A,value:"worldgen",children:_>100?"Parameters":"\uD83C\uDF10"}),(0,l.jsx)(m,{ref:B,value:"colors",children:W>100?"Colors":"\uD83C\uDFA8"})]}),(0,l.jsxs)(h,{value:"worldgen",className:"flex-1 bg-slate-50 border rounded-md p-2",children:[(0,l.jsx)("div",{children:(0,l.jsxs)("label",{children:[(0,l.jsxs)("span",{className:"p-2 font-bold text-xs",children:["Noise Scale: ",a]}),(0,l.jsx)(d,{className:"p-2",min:.01,max:.3,step:.01,value:[a],onValueChange:e=>s(e[0])})]})}),(0,l.jsx)("div",{children:(0,l.jsxs)("label",{children:[(0,l.jsxs)("span",{className:"p-2 font-bold text-xs",children:["Canvas Size: ",i]}),(0,l.jsx)(d,{className:"p-2",min:200,max:800,step:50,value:[i],onValueChange:e=>o(e[0])})]})}),(0,l.jsx)("div",{children:(0,l.jsxs)("label",{children:[(0,l.jsxs)("span",{className:"p-2 font-bold text-xs",children:["Max Distance Factor: ",b]}),(0,l.jsx)(d,{className:"p-2",min:.5,max:2,step:.1,value:[b],onValueChange:e=>w(e[0])})]})}),(0,l.jsx)("div",{children:(0,l.jsxs)("label",{children:[(0,l.jsxs)("span",{className:"p-2 font-bold text-xs",children:["Threshold: ",u]}),(0,l.jsx)(d,{className:"p-2",min:0,max:1,step:.05,value:[u],onValueChange:e=>p(e[0])})]})}),(0,l.jsx)("div",{children:(0,l.jsxs)("label",{children:[(0,l.jsxs)("span",{className:"p-2 font-bold text-xs",children:["Blur Iterations: ",y]}),(0,l.jsx)(d,{className:"p-2",min:0,max:10,step:1,value:[y],onValueChange:e=>{z(e[0])}})]})})]}),(0,l.jsxs)(h,{value:"colors",className:"flex-1 bg-slate-50 border rounded-md p-2",children:[(0,l.jsx)(S,{text:"Ambient Light",value:D,placeholder:r.KT,onChange:E}),(0,l.jsx)(S,{text:"Directional Light",value:F,placeholder:r.VB,onChange:M}),(0,l.jsx)(g,{type:"single",collapsible:!0,className:"w-full",children:(0,l.jsxs)(v,{value:"item-1",children:[(0,l.jsxs)(j,{className:"flex",children:[(0,l.jsx)("div",{className:"w-1/2 text-start",children:"Gradient"}),(0,l.jsx)("div",{className:"w-1/2 border h-full rounded-md mr-2 ml-4",style:{background:"linear-gradient(180deg, ".concat(k[3],", ").concat(k[2],", ").concat(k[1],", ").concat(k[0],")")}})]}),(0,l.jsx)(N,{children:(0,l.jsx)(C,{currentGradient:k,onChange:e=>{console.log(e),V(e)}})})]})})]})]})]})}):(0,l.jsx)(l.Fragment,{})}}}]);